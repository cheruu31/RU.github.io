<!DOCTYPE html>

<html class="dark" lang="zh-TW">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Game Over - VR Rhythm</title>
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com" rel="preconnect" />
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect" />
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&amp;display=swap"
        rel="stylesheet" />
    <link
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap"
        rel="stylesheet" />
    <link
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap"
        rel="stylesheet" />
    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#25c0f4",
                        "background-light": "#f5f8f8",
                        "background-dark": "#101e22",
                    },
                    fontFamily: {
                        "display": ["Space Grotesk", "sans-serif"]
                    },
                    borderRadius: { "DEFAULT": "0.5rem", "lg": "1rem", "xl": "1.5rem", "full": "9999px" },
                    animation: {
                        'pulse-slow': 'pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    }
                },
            },
        }
    </script>
    <style>
        /* Y2K / Cyberpunk Glitch Effect for Title */
        .neon-text {
            text-shadow: 0 0 10px rgba(37, 192, 244, 0.7),
                0 0 20px rgba(37, 192, 244, 0.5),
                0 0 40px rgba(37, 192, 244, 0.3);
        }

        .glass-panel {
            background: rgba(16, 30, 34, 0.6);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
        }

        .glass-button {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            border: 1px solid rgba(255, 255, 255, 0.15);
            transition: all 0.3s ease;
        }

        .glass-button:hover {
            background: rgba(37, 192, 244, 0.15);
            border-color: rgba(37, 192, 244, 0.5);
            box-shadow: 0 0 15px rgba(37, 192, 244, 0.2);
        }

        /* Scanline effect */
        .scanlines {
            background: linear-gradient(to bottom,
                    rgba(255, 255, 255, 0),
                    rgba(255, 255, 255, 0) 50%,
                    rgba(0, 0, 0, 0.2) 50%,
                    rgba(0, 0, 0, 0.2));
            background-size: 100% 4px;
            pointer-events: none;
        }
    </style>
    <style>
        body {
            min-height: max(884px, 100dvh);
        }
    </style>
</head>

<body
    class="bg-background-dark text-white font-display antialiased overflow-hidden selection:bg-primary selection:text-background-dark">
    <!-- Main Container -->
    <div class="relative flex h-screen w-full flex-col items-center justify-center overflow-hidden">
        <!-- Background Layers -->
        <!-- 1. Deep Base Gradient -->
        <div class="absolute inset-0 bg-gradient-to-b from-[#050a0c] via-[#101e22] to-[#0a1518] z-0"></div>
        <!-- 2. Abstract Geometric/Cyber Shapes (Simulating Game World) -->
        <div class="absolute inset-0 z-0 opacity-30">
            <div
                class="absolute top-[-10%] left-[-10%] w-[50%] h-[50%] rounded-full bg-primary blur-[120px] animate-pulse-slow">
            </div>
            <div
                class="absolute bottom-[-10%] right-[-10%] w-[60%] h-[60%] rounded-full bg-purple-900 blur-[100px] opacity-60">
            </div>
        </div>
        <!-- 3. Grid Floor Perspective -->
        <div
            class="absolute bottom-0 w-full h-1/2 bg-[linear-gradient(to_right,#80808012_1px,transparent_1px),linear-gradient(to_bottom,#80808012_1px,transparent_1px)] bg-[size:40px_40px] [mask-image:linear-gradient(to_top,black,transparent)] perspective-[1000px] transform rotate-x-60 origin-bottom z-0">
        </div>
        <!-- 4. Scanlines Overlay -->
        <div class="absolute inset-0 scanlines z-10 opacity-30"></div>
        <!-- 5. Audio Spectrum Visualization (Static bars at bottom background) -->
        <div
            class="absolute bottom-0 left-0 right-0 h-64 flex items-end justify-center gap-1 opacity-20 pointer-events-none z-0 px-4">
            <div class="w-2 h-12 bg-primary rounded-t-sm"></div>
            <div class="w-2 h-24 bg-primary rounded-t-sm"></div>
            <div class="w-2 h-16 bg-primary rounded-t-sm"></div>
            <div class="w-2 h-32 bg-primary rounded-t-sm"></div>
            <div class="w-2 h-20 bg-primary rounded-t-sm"></div>
            <div class="w-2 h-40 bg-primary rounded-t-sm"></div>
            <div class="w-2 h-28 bg-primary rounded-t-sm"></div>
            <div class="w-2 h-14 bg-primary rounded-t-sm"></div>
            <div class="w-2 h-32 bg-primary rounded-t-sm"></div>
            <div class="w-2 h-48 bg-primary rounded-t-sm"></div>
            <div class="w-2 h-24 bg-primary rounded-t-sm"></div>
            <div class="w-2 h-12 bg-primary rounded-t-sm"></div>
        </div>
        <!-- Content Wrapper (Centered for VR/Mobile focus) -->
        <div
            class="relative z-20 flex w-full max-w-md flex-col items-center justify-between h-full max-h-[850px] p-6 py-12">
            <!-- Top Section: Header -->
            <div class="flex flex-col items-center gap-2 pt-8 animate-[fadeIn_0.5s_ease-out]">
                <div class="flex items-center gap-2 mb-2">
                    <span class="material-symbols-outlined text-primary text-3xl">equalizer</span>
                    <span class="text-gray-400 text-xs tracking-[0.3em] uppercase">System Notification</span>
                </div>
                <h1
                    class="text-white neon-text tracking-widest text-5xl md:text-6xl font-bold leading-tight text-center uppercase italic">
                    遊戲結束
                </h1>
                <p class="text-primary/80 text-sm tracking-[0.5em] uppercase mt-2">Mission Complete</p>
            </div>
            <!-- Middle Section: HUD Stats -->
            <div class="w-full flex flex-col gap-4 my-8">
                <!-- Main Score Card -->
                <div
                    class="glass-panel rounded-2xl p-8 flex flex-col items-center justify-center relative overflow-hidden group">
                    <!-- Decor corners -->
                    <div class="absolute top-3 left-3 w-2 h-2 border-t-2 border-l-2 border-primary/50"></div>
                    <div class="absolute top-3 right-3 w-2 h-2 border-t-2 border-r-2 border-primary/50"></div>
                    <div class="absolute bottom-3 left-3 w-2 h-2 border-b-2 border-l-2 border-primary/50"></div>
                    <div class="absolute bottom-3 right-3 w-2 h-2 border-b-2 border-r-2 border-primary/50"></div>
                    <p class="text-gray-400 text-sm tracking-[0.2em] font-medium uppercase mb-2">Final Score</p>
                    <div class="flex items-baseline gap-1">
                        <span id="final-score"
                            class="text-5xl font-bold text-white drop-shadow-lg tracking-tighter">0</span>
                    </div>
                    <!-- Decorative line -->
                    <div
                        class="w-full h-[1px] bg-gradient-to-r from-transparent via-primary/30 to-transparent mt-6 mb-4">
                    </div>
                    <!-- Secondary Stats -->
                    <div class="flex w-full justify-between items-center px-4">
                        <div class="flex flex-col items-center">
                            <span class="text-gray-400 text-xs uppercase tracking-wider">Rank</span>
                            <span id="rank-val" class="text-2xl font-bold text-primary italic">-</span>
                        </div>
                        <div class="h-8 w-[1px] bg-white/10"></div>
                        <div class="flex flex-col items-center">
                            <span class="text-gray-400 text-xs uppercase tracking-wider">Perfect</span>
                            <span id="perfect-count" class="text-xl font-bold text-white">0</span>
                        </div>
                        <div class="h-8 w-[1px] bg-white/10"></div>
                        <div class="flex flex-col items-center">
                            <span class="text-gray-400 text-xs uppercase tracking-wider">Miss</span>
                            <span id="miss-count" class="text-xl font-bold text-white">0</span>
                        </div>
                    </div>
                </div>
                <!-- Combo Card (Smaller) -->
                <div
                    class="glass-panel rounded-xl p-4 flex items-center justify-between px-6 border-l-4 border-l-primary">
                    <div class="flex flex-col">
                        <p class="text-gray-400 text-xs tracking-wider uppercase">Max Combo</p>
                        <p class="text-white tracking-tight text-2xl font-bold"><span id="max-combo-val">0</span> <span
                                class="text-sm font-normal text-primary/70">x</span></p>
                    </div>
                    <span class="material-symbols-outlined text-primary/40 text-4xl">bolt</span>
                </div>
            </div>
            <!-- Bottom Section: Actions -->
            <div class="w-full flex flex-col gap-4 pb-8">
                <button onclick="window.location.href='play.html'"
                    class="group relative flex w-full cursor-pointer items-center justify-center overflow-hidden rounded-xl h-14 px-6 bg-primary text-[#101e22] text-lg font-bold tracking-wide shadow-[0_0_20px_rgba(37,192,244,0.3)] hover:shadow-[0_0_30px_rgba(37,192,244,0.5)] transition-all duration-300">
                    <div
                        class="absolute inset-0 bg-white/20 translate-y-full group-hover:translate-y-0 transition-transform duration-300">
                    </div>
                    <span
                        class="material-symbols-outlined mr-2 group-hover:rotate-180 transition-transform duration-500">replay</span>
                    <span class="relative z-10">再玩一次</span>
                </button>
                <button onclick="window.location.href='index.html'"
                    class="glass-button flex w-full cursor-pointer items-center justify-center overflow-hidden rounded-xl h-14 px-6 text-white text-base font-bold tracking-wide group">
                    <span
                        class="material-symbols-outlined mr-2 text-gray-400 group-hover:text-white transition-colors">home</span>
                    <span class="group-hover:text-white text-gray-200 transition-colors">回到主選單</span>
                </button>
            </div>
        </div>
    </div>
    <script>
        window.addEventListener('DOMContentLoaded', () => {
            const statsJson = localStorage.getItem('lastGameStats');
            if (!statsJson) return;

            const stats = JSON.parse(statsJson);

            // 1. Update Basic UI
            document.getElementById('final-score').textContent = stats.score.toLocaleString();
            document.getElementById('perfect-count').textContent = stats.perfect;
            document.getElementById('miss-count').textContent = stats.miss;
            document.getElementById('max-combo-val').textContent = stats.maxCombo;

            // 2. Rank Logic
            let rank = 'C';
            if (stats.miss === 0) {
                const perfectRatio = stats.totalNotes > 0 ? (stats.perfect / stats.totalNotes) : 0;
                rank = perfectRatio > 0.8 ? 'S' : 'A';
            } else if (stats.miss < 5) {
                rank = 'A';
            } else if (stats.miss < 15) {
                rank = 'B';
            }

            const rankEl = document.getElementById('rank-val');
            rankEl.textContent = rank;

            // Optional: Dynamic colors for Rank
            if (rank === 'S') rankEl.className = 'text-3xl font-black text-yellow-400 italic drop-shadow-[0_0_10px_rgba(250,204,21,0.5)]';
            else if (rank === 'A') rankEl.className = 'text-2xl font-bold text-cyan-400 italic';
            else rankEl.className = 'text-2xl font-bold text-gray-500 italic';
        });
    </script>
</body>

</html>